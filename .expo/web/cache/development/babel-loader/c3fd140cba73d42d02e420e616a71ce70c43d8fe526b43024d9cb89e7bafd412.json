{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport axios from \"axios\";\nimport { apiCreateOrderDetail } from \"../../api/OrderDetailAPI\";\nimport { getAccessTokenFromStorage } from \"../../utils/TokenStorage\";\nimport { handleTokenRefresh } from \"../jwtService/jwtServices\";\nexport var createOrderDetail = function () {\n  var _ref = _asyncToGenerator(function* (ORDER_ID, FOOD_ID, UNIT_QUANTITY, UNIT_PRICE) {\n    var callCount = 0;\n    var createOrderDetailInternal = function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        if (callCount < 2) {\n          try {\n            callCount++;\n            var orderDetail = {\n              ORDER_ID: ORDER_ID,\n              FOOD_ID: FOOD_ID,\n              UNIT_QUANTITY: UNIT_QUANTITY,\n              UNIT_PRICE: UNIT_PRICE\n            };\n            var accessToken = yield getAccessTokenFromStorage();\n            axios.post(apiCreateOrderDetail, orderDetail, {\n              headers: {\n                Authorization: `Bearer ${accessToken}`,\n                'Content-Type': 'application/json'\n              }\n            }).then(function (response) {\n              if (response.data.status === 401) {\n                handleTokenRefresh();\n                createOrderDetailInternal();\n              } else {\n                console.log('Đã tạo order detail');\n                callCount = 0;\n                return response.data;\n              }\n            }).catch(function (error) {\n              console.log(error.message);\n              alert('Lỗi khi tạo order detail');\n            });\n          } catch (error) {\n            throw new Error('Error creating order detail: ' + error.message);\n          }\n        } else {\n          alert('Đăng nhập hết hạn. Vui lòng đăng nhập lại');\n        }\n      });\n      return function createOrderDetailInternal() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    createOrderDetailInternal();\n  });\n  return function createOrderDetail(_x, _x2, _x3, _x4) {\n    return _ref.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["axios","apiCreateOrderDetail","getAccessTokenFromStorage","handleTokenRefresh","createOrderDetail","_ref","_asyncToGenerator","ORDER_ID","FOOD_ID","UNIT_QUANTITY","UNIT_PRICE","callCount","createOrderDetailInternal","_ref2","orderDetail","accessToken","post","headers","Authorization","then","response","data","status","console","log","catch","error","message","alert","Error","apply","arguments","_x","_x2","_x3","_x4"],"sources":["/Users/chuduchung/Documents/doan-reactnative/react-native-app/react-native-food/services/orderDetailService/createOrderDetail.tsx"],"sourcesContent":["import axios from \"axios\";\nimport {apiCreateOrderDetail} from '../../api/OrderDetailAPI'\nimport { getAccessTokenFromStorage } from '../../utils/TokenStorage';\nimport {handleTokenRefresh} from '../jwtService/jwtServices'\n\nexport const createOrderDetail = async(ORDER_ID:number, FOOD_ID:number, UNIT_QUANTITY:number, UNIT_PRICE:number)=>{\n    let callCount = 0\n    const createOrderDetailInternal = async() =>{\n        if(callCount < 2){\n            try {\n                callCount++\n                const orderDetail = {\n                    ORDER_ID,\n                    FOOD_ID, \n                    UNIT_QUANTITY,\n                    UNIT_PRICE\n                }\n\n                const  accessToken = await getAccessTokenFromStorage()\n                \n                axios.post(apiCreateOrderDetail,orderDetail, {\n                    headers : {\n                        Authorization: `Bearer ${accessToken}`,\n                        'Content-Type': 'application/json',\n                      }\n                })\n                .then(response => {\n                    if(response.data.status === 401){\n                        handleTokenRefresh()\n                        createOrderDetailInternal()\n                    }else{\n                        console.log('Đã tạo order detail')\n                        callCount= 0\n                        return response.data\n                    }\n                })\n                .catch((error) => { \n                    console.log(error.message)\n                    alert('Lỗi khi tạo order detail')\n                })\n            }\n            catch  (error:any) {\n                throw new Error('Error creating order detail: ' + error.message);\n            }\n            \n        }else{\n            alert('Đăng nhập hết hạn. Vui lòng đăng nhập lại')\n        }\n    }\n    createOrderDetailInternal()\n\n}\n\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAAQC,oBAAoB;AAC5B,SAASC,yBAAyB;AAClC,SAAQC,kBAAkB;AAE1B,OAAO,IAAMC,iBAAiB;EAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,WAAMC,QAAe,EAAEC,OAAc,EAAEC,aAAoB,EAAEC,UAAiB,EAAG;IAC9G,IAAIC,SAAS,GAAG,CAAC;IACjB,IAAMC,yBAAyB;MAAA,IAAAC,KAAA,GAAAP,iBAAA,CAAG,aAAU;QACxC,IAAGK,SAAS,GAAG,CAAC,EAAC;UACb,IAAI;YACAA,SAAS,EAAE;YACX,IAAMG,WAAW,GAAG;cAChBP,QAAQ,EAARA,QAAQ;cACRC,OAAO,EAAPA,OAAO;cACPC,aAAa,EAAbA,aAAa;cACbC,UAAU,EAAVA;YACJ,CAAC;YAED,IAAOK,WAAW,SAASb,yBAAyB,CAAC,CAAC;YAEtDF,KAAK,CAACgB,IAAI,CAACf,oBAAoB,EAACa,WAAW,EAAE;cACzCG,OAAO,EAAG;gBACNC,aAAa,EAAG,UAASH,WAAY,EAAC;gBACtC,cAAc,EAAE;cAClB;YACN,CAAC,CAAC,CACDI,IAAI,CAAC,UAAAC,QAAQ,EAAI;cACd,IAAGA,QAAQ,CAACC,IAAI,CAACC,MAAM,KAAK,GAAG,EAAC;gBAC5BnB,kBAAkB,CAAC,CAAC;gBACpBS,yBAAyB,CAAC,CAAC;cAC/B,CAAC,MAAI;gBACDW,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC;gBAClCb,SAAS,GAAE,CAAC;gBACZ,OAAOS,QAAQ,CAACC,IAAI;cACxB;YACJ,CAAC,CAAC,CACDI,KAAK,CAAC,UAACC,KAAK,EAAK;cACdH,OAAO,CAACC,GAAG,CAACE,KAAK,CAACC,OAAO,CAAC;cAC1BC,KAAK,CAAC,0BAA0B,CAAC;YACrC,CAAC,CAAC;UACN,CAAC,CACD,OAAQF,KAAS,EAAE;YACf,MAAM,IAAIG,KAAK,CAAC,+BAA+B,GAAGH,KAAK,CAACC,OAAO,CAAC;UACpE;QAEJ,CAAC,MAAI;UACDC,KAAK,CAAC,2CAA2C,CAAC;QACtD;MACJ,CAAC;MAAA,gBAzCKhB,yBAAyBA,CAAA;QAAA,OAAAC,KAAA,CAAAiB,KAAA,OAAAC,SAAA;MAAA;IAAA,GAyC9B;IACDnB,yBAAyB,CAAC,CAAC;EAE/B,CAAC;EAAA,gBA9CYR,iBAAiBA,CAAA4B,EAAA,EAAAC,GAAA,EAAAC,GAAA,EAAAC,GAAA;IAAA,OAAA9B,IAAA,CAAAyB,KAAA,OAAAC,SAAA;EAAA;AAAA,GA8C7B"},"metadata":{},"sourceType":"module","externalDependencies":[]}