{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport axios from \"axios\";\nimport { getAccessTokenFromStorage } from \"../../utils/TokenStorage\";\nimport { apiUpdateFood } from \"../../api/FoodAPI\";\nimport { handleTokenRefresh } from \"../jwtService/jwtServices\";\nexport var updateFood = function updateFood(foodId, imageUri, foodName, foodInfo, foodPrice, foodQuantity, foodCategory) {\n  var callCount = 0;\n  var updateFoodInternal = function () {\n    var _ref = _asyncToGenerator(function* () {\n      if (callCount < 2) {\n        try {\n          callCount++;\n          if (!foodId || !imageUri || !foodName || !foodInfo || !foodPrice || !foodQuantity || !foodCategory) {\n            alert('Vui lòng điền đầy đủ thông tin về món ăn');\n            return;\n          }\n          var formData = new FormData();\n          formData.append('FOOD_PICTURE', imageUri);\n          formData.append('FOOD_NAME', foodName);\n          formData.append('FOOD_INFO', foodInfo);\n          formData.append('FOOD_PRICE', foodPrice);\n          formData.append('FOOD_QUANTITY', foodQuantity);\n          formData.append('CATEGORY', foodCategory);\n          var accessToken = yield getAccessTokenFromStorage();\n          yield axios.put(apiUpdateFood + foodId, formData, {\n            headers: {\n              Authorization: `Bearer ${accessToken}`,\n              Accept: 'application/json',\n              'Content-Type': 'multipart/form-data'\n            }\n          }).then(function (response) {\n            if (response.data.status === 401) {\n              handleTokenRefresh();\n              updateFoodInternal();\n            } else {\n              alert('Món ăn đã được cập nhật');\n              callCount = 0;\n              return response.data;\n            }\n          }).catch(function (error) {\n            console.log(error.message);\n            alert('Lỗi cập nhật món ăn:');\n          });\n        } catch (error) {\n          throw new Error('Error updating food: ' + error.message);\n        }\n      } else {\n        alert('Cập nhật món ăn lỗi. Vui lòng đăng nhập lại');\n      }\n    });\n    return function updateFoodInternal() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  updateFoodInternal();\n};","map":{"version":3,"names":["axios","getAccessTokenFromStorage","apiUpdateFood","handleTokenRefresh","updateFood","foodId","imageUri","foodName","foodInfo","foodPrice","foodQuantity","foodCategory","callCount","updateFoodInternal","_ref","_asyncToGenerator","alert","formData","FormData","append","accessToken","put","headers","Authorization","Accept","then","response","data","status","catch","error","console","log","message","Error","apply","arguments"],"sources":["/Users/chuduchung/Documents/doan-reactnative/react-native-app/react-native-food/services/foodService/updateFood.tsx"],"sourcesContent":["import axios from \"axios\";\nimport {getAccessTokenFromStorage} from '../../utils/TokenStorage'\nimport {apiUpdateFood} from '../../api/FoodAPI'\nimport {handleTokenRefresh} from '../jwtService/jwtServices'\n\nexport const updateFood = (\n    foodId: string,\n    imageUri: string,\n    foodName: string,\n    foodInfo: string,\n    foodPrice: string,\n    foodQuantity: string,\n    foodCategory: string\n  ) => {\n    let callCount = 0;\n    const updateFoodInternal = async () => {\n      if (callCount < 2) {\n        try {\n          callCount++;\n          if (\n            !foodId ||\n            !imageUri ||\n            !foodName ||\n            !foodInfo ||\n            !foodPrice ||\n            !foodQuantity ||\n            !foodCategory\n          ) {\n            alert('Vui lòng điền đầy đủ thông tin về món ăn');\n            return;\n          }\n\n          const formData = new FormData();\n  \n          formData.append('FOOD_PICTURE', imageUri);\n          formData.append('FOOD_NAME', foodName);\n          formData.append('FOOD_INFO', foodInfo);\n          formData.append('FOOD_PRICE', foodPrice);\n          formData.append('FOOD_QUANTITY', foodQuantity);\n          formData.append('CATEGORY', foodCategory);\n  \n          const accessToken = await getAccessTokenFromStorage();\n          await axios\n            .put(apiUpdateFood + foodId, formData, {\n              headers: {\n                Authorization: `Bearer ${accessToken}`,\n                Accept: 'application/json',\n                'Content-Type': 'multipart/form-data',\n              },\n            })\n            .then((response) => {\n              if (response.data.status === 401) {\n                handleTokenRefresh();\n                updateFoodInternal();\n              } else {\n                alert('Món ăn đã được cập nhật');\n                callCount = 0;\n                return response.data;\n              }\n            })\n            .catch((error: any) => {\n              console.log(error.message);\n              alert('Lỗi cập nhật món ăn:');\n            });\n        } catch (error: any) {\n          throw new Error('Error updating food: ' + error.message);\n        }\n      } else {\n        alert('Cập nhật món ăn lỗi. Vui lòng đăng nhập lại');\n      }\n    };\n  \n    updateFoodInternal();\n  };\n  "],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAAQC,yBAAyB;AACjC,SAAQC,aAAa;AACrB,SAAQC,kBAAkB;AAE1B,OAAO,IAAMC,UAAU,GAAG,SAAbA,UAAUA,CACnBC,MAAc,EACdC,QAAgB,EAChBC,QAAgB,EAChBC,QAAgB,EAChBC,SAAiB,EACjBC,YAAoB,EACpBC,YAAoB,EACjB;EACH,IAAIC,SAAS,GAAG,CAAC;EACjB,IAAMC,kBAAkB;IAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,aAAY;MACrC,IAAIH,SAAS,GAAG,CAAC,EAAE;QACjB,IAAI;UACFA,SAAS,EAAE;UACX,IACE,CAACP,MAAM,IACP,CAACC,QAAQ,IACT,CAACC,QAAQ,IACT,CAACC,QAAQ,IACT,CAACC,SAAS,IACV,CAACC,YAAY,IACb,CAACC,YAAY,EACb;YACAK,KAAK,CAAC,0CAA0C,CAAC;YACjD;UACF;UAEA,IAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;UAE/BD,QAAQ,CAACE,MAAM,CAAC,cAAc,EAAEb,QAAQ,CAAC;UACzCW,QAAQ,CAACE,MAAM,CAAC,WAAW,EAAEZ,QAAQ,CAAC;UACtCU,QAAQ,CAACE,MAAM,CAAC,WAAW,EAAEX,QAAQ,CAAC;UACtCS,QAAQ,CAACE,MAAM,CAAC,YAAY,EAAEV,SAAS,CAAC;UACxCQ,QAAQ,CAACE,MAAM,CAAC,eAAe,EAAET,YAAY,CAAC;UAC9CO,QAAQ,CAACE,MAAM,CAAC,UAAU,EAAER,YAAY,CAAC;UAEzC,IAAMS,WAAW,SAASnB,yBAAyB,CAAC,CAAC;UACrD,MAAMD,KAAK,CACRqB,GAAG,CAACnB,aAAa,GAAGG,MAAM,EAAEY,QAAQ,EAAE;YACrCK,OAAO,EAAE;cACPC,aAAa,EAAG,UAASH,WAAY,EAAC;cACtCI,MAAM,EAAE,kBAAkB;cAC1B,cAAc,EAAE;YAClB;UACF,CAAC,CAAC,CACDC,IAAI,CAAC,UAACC,QAAQ,EAAK;YAClB,IAAIA,QAAQ,CAACC,IAAI,CAACC,MAAM,KAAK,GAAG,EAAE;cAChCzB,kBAAkB,CAAC,CAAC;cACpBU,kBAAkB,CAAC,CAAC;YACtB,CAAC,MAAM;cACLG,KAAK,CAAC,yBAAyB,CAAC;cAChCJ,SAAS,GAAG,CAAC;cACb,OAAOc,QAAQ,CAACC,IAAI;YACtB;UACF,CAAC,CAAC,CACDE,KAAK,CAAC,UAACC,KAAU,EAAK;YACrBC,OAAO,CAACC,GAAG,CAACF,KAAK,CAACG,OAAO,CAAC;YAC1BjB,KAAK,CAAC,sBAAsB,CAAC;UAC/B,CAAC,CAAC;QACN,CAAC,CAAC,OAAOc,KAAU,EAAE;UACnB,MAAM,IAAII,KAAK,CAAC,uBAAuB,GAAGJ,KAAK,CAACG,OAAO,CAAC;QAC1D;MACF,CAAC,MAAM;QACLjB,KAAK,CAAC,6CAA6C,CAAC;MACtD;IACF,CAAC;IAAA,gBAvDKH,kBAAkBA,CAAA;MAAA,OAAAC,IAAA,CAAAqB,KAAA,OAAAC,SAAA;IAAA;EAAA,GAuDvB;EAEDvB,kBAAkB,CAAC,CAAC;AACtB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}