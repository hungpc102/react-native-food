{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport axios from 'axios';\nimport { foodApiCreate } from \"../../api/FoodAPI\";\nimport { getAccessTokenFromStorage } from \"../../utils/TokenStorage\";\nimport { handleTokenRefresh } from \"../jwtService/jwtServices\";\nexport var createFood = function createFood(imageUri, foodName, foodInfo, foodPrice, foodQuantity, foodCategory) {\n  var callCount = 0;\n  var createFoodInternal = function () {\n    var _ref = _asyncToGenerator(function* () {\n      if (callCount < 2) {\n        try {\n          callCount++;\n          if (!imageUri || !foodName || !foodInfo || !foodPrice || !foodQuantity || !foodCategory) {\n            alert('Vui lòng điền đầy đủ thông tin về món ăn');\n            return;\n          }\n          var formData = new FormData();\n          formData.append('FOOD_PICTURE', imageUri);\n          formData.append('FOOD_NAME', foodName);\n          formData.append('FOOD_INFO', foodInfo);\n          formData.append('FOOD_PRICE', foodPrice);\n          formData.append('FOOD_QUANTITY', foodQuantity);\n          formData.append('CATEGORY', foodCategory);\n          var accessToken = yield getAccessTokenFromStorage();\n          yield axios.post(foodApiCreate, formData, {\n            headers: {\n              Authorization: `Bearer ${accessToken}`,\n              Accept: 'application/json',\n              'Content-Type': 'multipart/form-data'\n            }\n          }).then(function (response) {\n            if (response.data.status === 401) {\n              handleTokenRefresh();\n              createFoodInternal();\n            } else {\n              alert('Món ăn đã được tạo');\n              callCount = 0;\n              return response.data;\n            }\n          }).catch(function (error) {\n            console.log(error.message);\n            alert('Lỗi tạo món ăn:');\n          });\n        } catch (error) {\n          throw new Error('Error creating food: ' + error.message);\n        }\n      } else {\n        alert('Đăng nhập hết hạn. Vui lòng đăng nhập lại');\n      }\n    });\n    return function createFoodInternal() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  createFoodInternal();\n};","map":{"version":3,"names":["axios","foodApiCreate","getAccessTokenFromStorage","handleTokenRefresh","createFood","imageUri","foodName","foodInfo","foodPrice","foodQuantity","foodCategory","callCount","createFoodInternal","_ref","_asyncToGenerator","alert","formData","FormData","append","accessToken","post","headers","Authorization","Accept","then","response","data","status","catch","error","console","log","message","Error","apply","arguments"],"sources":["/Users/chuduchung/Documents/doan-reactnative/react-native-app/react-native-food/services/foodService/createFoodServices.tsx"],"sourcesContent":["\nimport axios from 'axios';\nimport { foodApiCreate } from '../../api/FoodAPI';\nimport { getAccessTokenFromStorage } from '../../utils/TokenStorage';\nimport {handleTokenRefresh} from '../jwtService/jwtServices'\n\nexport const createFood =  (\n    imageUri: string, \n    foodName: string, \n    foodInfo: string, \n    foodPrice: string, \n    foodQuantity: string, \n    foodCategory: string) => {\n        let callCount = 0\n    const createFoodInternal = async () =>{\n        if(callCount < 2){\n            try {\n                callCount++\n                if( !imageUri ||!foodName || !foodInfo || !foodPrice || !foodQuantity || !foodCategory){\n                    alert('Vui lòng điền đầy đủ thông tin về món ăn')\n                    return\n                }\n               \n                  \n                const formData = new FormData();\n                  \n                formData.append('FOOD_PICTURE', imageUri); \n                formData.append('FOOD_NAME', foodName);\n                formData.append('FOOD_INFO', foodInfo);\n                formData.append('FOOD_PRICE', foodPrice);\n                formData.append('FOOD_QUANTITY', foodQuantity);\n                formData.append('CATEGORY', foodCategory);\n                 const  accessToken = await getAccessTokenFromStorage()\n                await axios.post(foodApiCreate, formData, {\n                  headers: {\n                    Authorization: `Bearer ${accessToken}`,\n                    Accept: 'application/json',\n                    'Content-Type': 'multipart/form-data', \n                  }\n                })\n                .then(response => {\n            \n                        if(response.data.status === 401){\n                             handleTokenRefresh()\n                             createFoodInternal()\n                         }else{\n                            alert('Món ăn đã được tạo')\n                            callCount= 0\n                            return response.data\n                         }\n                })\n                .catch((error:any) => { \n                    console.log(error.message)\n                    alert('Lỗi tạo món ăn:')\n                })\n              } catch (error:any) {\n                throw new Error('Error creating food: ' + error.message);\n              }\n        }else{\n            alert('Đăng nhập hết hạn. Vui lòng đăng nhập lại')\n        }\n    }\n        \n    createFoodInternal()\n}\n"],"mappings":";AACA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,aAAa;AACtB,SAASC,yBAAyB;AAClC,SAAQC,kBAAkB;AAE1B,OAAO,IAAMC,UAAU,GAAI,SAAdA,UAAUA,CACnBC,QAAgB,EAChBC,QAAgB,EAChBC,QAAgB,EAChBC,SAAiB,EACjBC,YAAoB,EACpBC,YAAoB,EAAK;EACrB,IAAIC,SAAS,GAAG,CAAC;EACrB,IAAMC,kBAAkB;IAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,aAAW;MAClC,IAAGH,SAAS,GAAG,CAAC,EAAC;QACb,IAAI;UACAA,SAAS,EAAE;UACX,IAAI,CAACN,QAAQ,IAAG,CAACC,QAAQ,IAAI,CAACC,QAAQ,IAAI,CAACC,SAAS,IAAI,CAACC,YAAY,IAAI,CAACC,YAAY,EAAC;YACnFK,KAAK,CAAC,0CAA0C,CAAC;YACjD;UACJ;UAGA,IAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;UAE/BD,QAAQ,CAACE,MAAM,CAAC,cAAc,EAAEb,QAAQ,CAAC;UACzCW,QAAQ,CAACE,MAAM,CAAC,WAAW,EAAEZ,QAAQ,CAAC;UACtCU,QAAQ,CAACE,MAAM,CAAC,WAAW,EAAEX,QAAQ,CAAC;UACtCS,QAAQ,CAACE,MAAM,CAAC,YAAY,EAAEV,SAAS,CAAC;UACxCQ,QAAQ,CAACE,MAAM,CAAC,eAAe,EAAET,YAAY,CAAC;UAC9CO,QAAQ,CAACE,MAAM,CAAC,UAAU,EAAER,YAAY,CAAC;UACxC,IAAOS,WAAW,SAASjB,yBAAyB,CAAC,CAAC;UACvD,MAAMF,KAAK,CAACoB,IAAI,CAACnB,aAAa,EAAEe,QAAQ,EAAE;YACxCK,OAAO,EAAE;cACPC,aAAa,EAAG,UAASH,WAAY,EAAC;cACtCI,MAAM,EAAE,kBAAkB;cAC1B,cAAc,EAAE;YAClB;UACF,CAAC,CAAC,CACDC,IAAI,CAAC,UAAAC,QAAQ,EAAI;YAEV,IAAGA,QAAQ,CAACC,IAAI,CAACC,MAAM,KAAK,GAAG,EAAC;cAC3BxB,kBAAkB,CAAC,CAAC;cACpBS,kBAAkB,CAAC,CAAC;YACxB,CAAC,MAAI;cACFG,KAAK,CAAC,oBAAoB,CAAC;cAC3BJ,SAAS,GAAE,CAAC;cACZ,OAAOc,QAAQ,CAACC,IAAI;YACvB;UACT,CAAC,CAAC,CACDE,KAAK,CAAC,UAACC,KAAS,EAAK;YAClBC,OAAO,CAACC,GAAG,CAACF,KAAK,CAACG,OAAO,CAAC;YAC1BjB,KAAK,CAAC,iBAAiB,CAAC;UAC5B,CAAC,CAAC;QACJ,CAAC,CAAC,OAAOc,KAAS,EAAE;UAClB,MAAM,IAAII,KAAK,CAAC,uBAAuB,GAAGJ,KAAK,CAACG,OAAO,CAAC;QAC1D;MACN,CAAC,MAAI;QACDjB,KAAK,CAAC,2CAA2C,CAAC;MACtD;IACJ,CAAC;IAAA,gBA/CKH,kBAAkBA,CAAA;MAAA,OAAAC,IAAA,CAAAqB,KAAA,OAAAC,SAAA;IAAA;EAAA,GA+CvB;EAEDvB,kBAAkB,CAAC,CAAC;AACxB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}