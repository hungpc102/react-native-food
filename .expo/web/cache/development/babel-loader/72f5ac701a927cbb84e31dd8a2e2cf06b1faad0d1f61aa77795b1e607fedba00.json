{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { getAccessTokenFromStorage } from \"../../utils/TokenStorage\";\nimport axios from 'axios';\nimport { apiDeleteFood } from \"../../api/FoodAPI\";\nimport { handleTokenRefresh } from \"../jwtService/jwtServices\";\nvar callCount = 0;\nexport var deleteFood = function () {\n  var _ref = _asyncToGenerator(function* (foodId, setModalVisible) {\n    if (!foodId) {\n      return alert('Vui lòng nhập id món ăn');\n    }\n    if (callCount < 2) {\n      callCount++;\n      var accessToken = yield getAccessTokenFromStorage();\n      try {\n        var response = yield axios.delete(apiDeleteFood + foodId, {\n          headers: {\n            Authorization: `Bearer ${accessToken}`\n          }\n        });\n        if (response.status === 204) {\n          console.log('Món ăn đã được xoá thành công.');\n          callCount = 0;\n          alert('Món ăn đã được xoá thành công');\n        } else {\n          yield handleTokenRefresh();\n          deleteFood(foodId, setModalVisible);\n        }\n      } catch (error) {\n        console.error('Lỗi khi xoá món ăn:', error);\n      } finally {\n        setModalVisible(false);\n      }\n      ;\n    } else {\n      alert('Lỗi khi xoá món ăn. Vui lòng đăng nhập lại');\n    }\n  });\n  return function deleteFood(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["getAccessTokenFromStorage","axios","apiDeleteFood","handleTokenRefresh","callCount","deleteFood","_ref","_asyncToGenerator","foodId","setModalVisible","alert","accessToken","response","delete","headers","Authorization","status","console","log","error","_x","_x2","apply","arguments"],"sources":["/Users/chuduchung/Documents/doan-reactnative/react-native-app/react-native-food/services/foodService/deleteFoodServices.tsx"],"sourcesContent":["\nimport {getAccessTokenFromStorage} from '../../utils/TokenStorage'\nimport axios from 'axios';\nimport {apiDeleteFood} from '../../api/FoodAPI'\nimport {handleTokenRefresh} from '../jwtService/jwtServices'\nlet callCount = 0\n export const deleteFood = async (foodId:string, setModalVisible:(modalVisible:boolean)=> void) => {\n  if(!foodId){\n    return alert('Vui lòng nhập id món ăn')\n  }\n  if(callCount < 2){\n    callCount++;\n    const accessToken = await getAccessTokenFromStorage()\n    try {\n      const response = await axios.delete(apiDeleteFood + foodId, {\n        headers: {\n          Authorization: `Bearer ${accessToken}`,\n        },\n      });\n  \n      if (response.status === 204) {\n        console.log('Món ăn đã được xoá thành công.');\n        callCount = 0\n        alert('Món ăn đã được xoá thành công')\n  \n      } else {\n        await handleTokenRefresh()\n        deleteFood(foodId, setModalVisible)\n      }\n    } catch (error) {\n      console.error('Lỗi khi xoá món ăn:', error);\n    }\n    finally{\n      setModalVisible(false)\n    };\n  }else{\n    alert('Lỗi khi xoá món ăn. Vui lòng đăng nhập lại')\n  }\n  \n};\n"],"mappings":";AACA,SAAQA,yBAAyB;AACjC,OAAOC,KAAK,MAAM,OAAO;AACzB,SAAQC,aAAa;AACrB,SAAQC,kBAAkB;AAC1B,IAAIC,SAAS,GAAG,CAAC;AAChB,OAAO,IAAMC,UAAU;EAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,WAAOC,MAAa,EAAEC,eAA6C,EAAK;IACjG,IAAG,CAACD,MAAM,EAAC;MACT,OAAOE,KAAK,CAAC,yBAAyB,CAAC;IACzC;IACA,IAAGN,SAAS,GAAG,CAAC,EAAC;MACfA,SAAS,EAAE;MACX,IAAMO,WAAW,SAASX,yBAAyB,CAAC,CAAC;MACrD,IAAI;QACF,IAAMY,QAAQ,SAASX,KAAK,CAACY,MAAM,CAACX,aAAa,GAAGM,MAAM,EAAE;UAC1DM,OAAO,EAAE;YACPC,aAAa,EAAG,UAASJ,WAAY;UACvC;QACF,CAAC,CAAC;QAEF,IAAIC,QAAQ,CAACI,MAAM,KAAK,GAAG,EAAE;UAC3BC,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;UAC7Cd,SAAS,GAAG,CAAC;UACbM,KAAK,CAAC,+BAA+B,CAAC;QAExC,CAAC,MAAM;UACL,MAAMP,kBAAkB,CAAC,CAAC;UAC1BE,UAAU,CAACG,MAAM,EAAEC,eAAe,CAAC;QACrC;MACF,CAAC,CAAC,OAAOU,KAAK,EAAE;QACdF,OAAO,CAACE,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;MAC7C,CAAC,SACM;QACLV,eAAe,CAAC,KAAK,CAAC;MACxB;MAAC;IACH,CAAC,MAAI;MACHC,KAAK,CAAC,4CAA4C,CAAC;IACrD;EAEF,CAAC;EAAA,gBAjCaL,UAAUA,CAAAe,EAAA,EAAAC,GAAA;IAAA,OAAAf,IAAA,CAAAgB,KAAA,OAAAC,SAAA;EAAA;AAAA,GAiCvB"},"metadata":{},"sourceType":"module","externalDependencies":[]}